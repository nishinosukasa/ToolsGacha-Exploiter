<?php
//Mau recode gan  ? ya gpp sih asal cantumin aja pembuatnya
//Ane juga pengen terkenal gan :v
print "\033[1;32m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n";
print"**********************FDCI***********************\n";
print"**                   WEBDAV AUTO DORK          **\n";
print"**              Created By Abdul Muttaqin      **\n";
print"**           Forum Diskusi Cyber Indonesia     **\n";
print"**                            Group Fb         **\n";
print"**             facebook.com/groups/im523       **\n";
print"**                           My Facebook       **\n";
print"**        www.facebook.com/basmal106           **\n";
print"**********************FDCI***********************\n";
print"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n";
print"\033[1;31m_____\n";
print"< WELCOME TO MY TOOLS BRADA ^_^  >\n";
print" -----\n";
print"\033[1;34m        \   ^__^\n";
print"         \  (oo)\_______\n";
print"            (__)\       )\/\n";
print"                ||----w |\n";
print"                ||     ||\n\033[1;33m";

set_time_limit(0);

function getsource($url) {
    $curl = curl_init($url);
    curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);
    $content = curl_exec($curl);
    curl_close($curl);
    return $content;
}
function ngebing($dork,$nama){
$do = urlencode($dork);
if(isset($dork)) {
	$npage = 1;
	$npages = 30000;
	$allLinks = array();
	$lll = array();
	while($npage <= $npages) {
	    $x = getsource("http://www.bing.com/search?q=".$do."&first=".$npage);
	    if($x) {
	        preg_match_all('#<h2><a href="(.*?)" h="ID#', $x, $findlink);
	        foreach ($findlink[1] as $fl) array_push($allLinks, $fl);
	        $npage = $npage + 10;
	        if (preg_match("(first=" . $npage . "&amp)siU", $x, $linksuiv) == 0) break;
	    } else break;
	}
	$URLs = array();
	foreach($allLinks as $url){
	    $exp = explode("/", $url);
	    $URLs[] = $exp[2];
	}
	$array = array_filter($URLs);
	$array = array_unique($array);
	$sss = count(array_unique($array));
	echo "[+] Mendapatkan [ $sss ] Sitd\n\n";
	foreach($array as $domain) {
	$s= "http://$domain/\n";
	$fp = fopen($nama,"a");
	fwrite($fp,$s);
	fclose($fp);
	echo $s;
	}
}
}

function ngehek($url)
{
	global $merah,$hijau;
	$biru = "\033[1;33m";
	$ungu = "\033[1;35m";
	$netral = "\033[1;0m";

	$c= curl_init();
	$curl=array(
		CURLOPT_URL=>$url,
		CURLOPT_RETURNTRANSFER=>1,
		CURLOPT_FOLLOWLOCATION=>0,
		);
	curl_setopt_array($c,$curl);
	$e = curl_exec($c);
	if(preg_match("/hacked/i",$e)){
		echo $biru."~Situs Vuln~ ".$netral."\n";
		echo " Situs =>  ".$url."\n";
	}else{
		echo $ungu."~ Situs Ga Vuln ~".$netral."\n";
		echo "Situs => ".$url."\n";
	}
	curl_close($c);
}

$dork_lol = getopt("t:k:");
if(empty($dork_lol))
{

	echo "penggunaan : php ".$argv[0]." -t=\"dork-webdav\" -k \"output.txt\" \n\n";
}else{
ngebing($dork_lol['t'],$dork_lol['k']);
if(file_exists($dork_lol['k']))
{
	
$gc=file_get_contents($dork_lol['k']);
$exp = explode("\n",$gc);
foreach($exp as $x){
	$url = "";
	ngehek($x.$url);

}
}else{
	echo "[+] File Buat Hasil Nya Mana Gan? ";
}
}


?>